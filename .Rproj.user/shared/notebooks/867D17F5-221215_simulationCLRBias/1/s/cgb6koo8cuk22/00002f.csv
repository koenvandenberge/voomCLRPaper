"0","logit <- function(x) log(x/(1-x))"
"0","set.seed(495212344)"
"0","n <- 40 # sample size"
"0","P <- 10 # number of cell types"
"0","mu0 <- rnbinom(n=P, size=1/2, mu=400)"
"0","mu0[mu0==0] <- rnbinom(n=sum(mu0==0), size=1/2, mu=400) # absolute counts in group 0"
"0","beta <- rlnorm(n=P, meanlog = 0, sdlog=2) * # these are log-fold-changes"
"0","  rbinom(n=P, size=1, prob=.15) *"
"0","  sample(c(-1,1), size=P, replace=TRUE) # fold change on log scale"
"0","mu1 <- exp(beta) * mu0 # because we want log(mu2/mu1) = beta"
"0","log(mu1/(mu0)) # fold-changes OK"
"1"," [1]"
"1","  0.0000000"
"1","  0.0000000"
"1","  0.0000000"
"1","  0.0000000"
"1","  0.0000000"
"1","  0.0000000"
"1","  0.0000000"
"1"," -0.4724259"
"1","  0.0000000"
"1","  0.0000000"
"1","
"
"0","df <- data.frame(mu=c(mu0,mu1),"
"0","                 celltype=factor(rep(1:P,2)),"
"0","                 group=factor(rep(0:1,each=P)))"
"0","ggplot(df, aes(x=group, y=log1p(mu), group=celltype, col=celltype)) +"
"0","  geom_line()"
