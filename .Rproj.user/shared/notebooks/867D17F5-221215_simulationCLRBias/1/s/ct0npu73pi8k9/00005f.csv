"0","logit <- function(x) log(x/(1-x))"
"0","set.seed(498735212)"
"0","n <- 8 # sample size"
"0","P <- 20 # number of cell types"
"0","mu0 <- rnbinom(n=P, size=1/2, mu=400)"
"0","mu0 # absolute counts in group 0"
"1"," [1]"
"1","   23"
"1","    8"
"1","   23"
"1","   80"
"1","   29"
"1","  107"
"1","  153"
"1","  133"
"1","  698"
"1","  273"
"1","  279"
"1","  132"
"1","  125"
"1","  521"
"1","  559"
"1","  606"
"1"," 2162"
"1","    8"
"1","   92"
"1","  234"
"1","
"
"0","beta <- rep(0,P) # fold change on log scale"
"0","mu1 <- exp(beta) * mu0 # because we want log(mu2/mu1) = beta"
"0","log(mu1/(mu0)) # fold-changes OK"
"1"," [1]"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1","
"
"0","df <- data.frame(mu=c(mu0,mu1),"
"0","                 celltype=factor(rep(1:P,2)),"
"0","                 group=factor(rep(0:1,each=P)))"
"0","ggplot(df, aes(x=group, y=log1p(mu), group=celltype, col=celltype)) +"
"0","  geom_line()"
